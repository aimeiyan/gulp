$(function(){function i(){$(".jh-view-history-modal .jh-view-history-time-first-ul > li .jh-ul-title").click(function(){function i(e){$.ajax({url:"../data/viewHistory/dateContent.json",type:"post",data:{id:o,pageNum:e,pageSize:10},success:function(t){e+=1;for(var s="",o=0;o<t.length;o++)s+='<li><span class="jh-view-portrait"><img src="'+t[o].img+'" alt=""><a href="javacript:void(0);" class="jh-name">'+t[o].name+"</a></span><span>"+t[o].organ+"</span><span>"+t[o].job+"</span><span>"+t[o].time+"</span></li>";a.append(s),a.show(),$(".jh-view-history-time-first-ul").off("scrollreachbottom"),$(".jh-view-history-time-first-ul").on("scrollreachbottom",function(t){$(".jh-view-history-modal .jh-view-history-time-first-ul .optiscroll-content>li:last").addClass("active")&&i(e)})}})}var e=$(this),t=e.parent().siblings().length+1,s=e.parent().index(),o=$(this).attr("data-id"),a=$(this).next(".jh-view-history-time-second-ul"),l=!1;if($(this).next().is(":visible")&&(l=!0),l)$(this).next().hide(),$(this).closest("li").removeClass("active");else{if(e.parent().addClass("active"),a.find("li").length)return void a.show();if(s===t-1){i(1)}else $.ajax({url:"../data/viewHistory/dateContent.json",type:"post",data:{id:o},success:function(i){var e="";if(!i.length)return a.empty().append("<li style='font-weight: normal;text-align: center;color: #999;line-height: 2.5'>暂无数据</li>"),void a.show();for(var t=0;t<i.length;t++)e+='<li><span class="jh-view-portrait"><img src="'+i[t].img+'" alt=""><a href="javacript:void(0);" class="jh-name">'+i[t].name+"</a></span><span>"+i[t].organ+"</span><span>"+i[t].job+"</span><span>"+i[t].time+"</span></li>";a.empty().append(e),a.show()}})}})}function e(){$.ajax({url:"../data/viewHistory/date.json",type:"POST",data:{},success:function(e){for(var t="",a=0;a<e.length;a++)t+='<li><h3 class="jh-ul-title" data-id="'+e[a].id+'"><i class="jh-angle-icon jh-right"></i><i class="jh-time-icon"></i>'+e[a].date+'</h3><ul class="jh-view-history-time-second-ul">',t+="</ul></li>";$(".jh-view-history-modal .jh-view-history-time-first-ul").empty().append(t),i(),s=document.querySelector(".jh-view-history-time-first-ul"),o=new Optiscroll(s)}})}function t(i){i=i,$.ajax({url:"../data/viewHistory/number.json",type:"POST",data:{page:i,pageSize:10},success:function(e){if(0!==e.length){for(var s="",o=0;o<e.length;o++)s+='<li><span class="jh-view-portrait"><img src="'+e[o].img+'" alt=""><a href="javascript:void(0);" class="jh-name">'+e[o].name+"</a></span><span>"+e[o].organ+"</span><span>"+e[o].job+"</span><span>"+e[o].number+"次</span></li>";0===i?($(".jh-view-history-modal .jh-view-history-number-second-ul").append(s),a=document.querySelector(".jh-view-history-modal .jh-view-history-number-second-ul"),l=new Optiscroll(a)):$(".jh-view-history-modal .jh-view-history-number-second-ul .optiscroll-content").append(s),i+=1,$(".jh-view-history-number-second-ul").off("scrollreachbottom"),$(".jh-view-history-number-second-ul").on("scrollreachbottom",function(e){t(i)})}}})}$(".jh-compare-recent-people .jh-view-more a").click(function(){$(".jh-view-history-modal").show(),$(".jh-modal-overlay").show(),$(".jh-view-history-modal .jh-view-history-time-second-ul").hide(),$(".jh-view-history-modal .jh-view-history-time-first-ul li").removeClass("active")}),$(".jh-view-history-modal .jh-modal-close,.jh-view-history-modal .jh-modal-btn-cancel").click(function(){$(".jh-view-history-modal").hide(),$(".jh-modal-overlay").hide()}),$(".jh-select-view-type").off("click"),$(".jh-select-view-type").click(function(i){$(this).parent().find(".jh-select-list").toggle()}),$(".jh-angle-down-wrp").click(function(){$(this).closest(".jh-select-view-wrp").find(".jh-select-view-type").trigger("click")}),$(".jh-view-history-modal .jh-select-list li").off("click"),$(".jh-view-history-modal .jh-select-list li").click(function(){var i=$(this).attr("data-tab"),s=$(this).text(),o=$(this).closest(".jh-select-view-wrp").find(".jh-select-view-type");$(this).closest(".jh-select-list").hide(),s!==o.text()&&(o.text(s),"date"===i?($(".jh-view-history-tab").hide(),$("#jh-view-history-tab-date").show(),$(".jh-view-history-modal .jh-pages-container").css("display","none"),$(".jh-view-history-time-first-ul>li").length||e()):($(".jh-view-history-time-first-ul .jh-view-history-time-second-ul").hide(),$(".jh-view-history-tab").hide(),$("#jh-view-history-tab-number").show(),$(".jh-view-history-modal .jh-pages-container").css("display","block"),$(".jh-view-history-number-second-ul li").length||t(0)))}),$(".jh-view-history-modal .jh-select-list li").eq(0).trigger("click"),$("*").on("click",function(i){$(i.target).closest(".jh-select-view-wrp").length||$(".jh-view-history-modal .jh-select-list").hide()});var s,o,a,l;$(".jh-view-history-pages li").click(function(){$(this).addClass("active").siblings().removeClass("active");t(parseInt($(this).find("a").text()))})});